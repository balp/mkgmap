<body>
<h3>OpenStreetMap converter</h3>

<p>
    This package has the code to read in a file that is in the Open Stree Map
    format (.osm files). OSM uses an XML format.

<p>
		There are two versions of the api that have readers implemented here, they
		work out which one to use automatically.
</p>

<h4>OSM api version 0.4</h4>

<p>There are three XML elements of interest: <b>node</b>,
    <b>segment</b> and <b>way</b> as well as a <b>tag</b> element that is used
    to set arbitary properties on each of the main tags.
<dl>
    <dt>node</dt>
    <dd>A node can be a POI or simply used to define a segment - it can
		even be both, although I guess that is discouraged. To tell the difference
		we look through the tags and see if any match the name of a
		feature.</dd>

		<dt>segment</dt>
		<dd>This is an ordered pair of two points.  The points are referenced
		by the node id.  This means that you have to keep a map of all the
		nodes as you read them in so they can be used to work out what the
		co-ordinates of the segment are.</dd>

		<dt>way</dt>
		<dd>Line and polygon features are represented by a way.  A way is an
		ordered sequence of segments.  So we have to also save a map of all
		the segments to work out the points on the way.</dd>
</dl>

<p>This format is fairly difficult to translate into terms that are
		appropriate to Garmin maps for a fiew reasons. If you are writing a new
		input format, then you should look first at the <i>polish</i> format as
		that is much simpler to understand as it is designed for creating Garmin
		maps and so has no complicating requirements.

<h4>OSM api version 0.5</h4>

<p>This version of the format does away with segments.  Ways are sequences of
nodes.  As such it matches the format that we require for the Garmin maps
much closer.  Ways cannot branch or have out of order segments, so all the code
that deals with that is not required.</p>

<h3>About the conversion</h3>
<p>The following features of the OSM format need to be addressed to create
the map.  Note that some of these are not relavent to version 0.5 of the
OSM file format.

<ul>
		<li>Lines and polygons are not sequences of points, but sequences of
		segments - a segment is an ordered pair of two points.  We have to
		create a list of points out of them.  This would be easy if it were not
		for the next point. (Not 0.5)
		</li>

		<li>The segments that form a line or polygon are not necessarily in a
		sane order. Therefore we have to reorder them so that we end up with
		continguous points to form a line. (Not 0.5)
		</li>

		<li>Ways can branch and can be dis-contiguous. So after being reordered
		they need to be split up into separate lines.  (Not 0.5)</li>

		<li>There is no way to tell a polygon from a line feature apart from
		looking at the type of feature it is and going from there. Note that a
		line feature may form a loop (eg a roundabout, circular path in a park
		etc.) so you can't use that.  </li>

		<li>Map features are represented by tags.  There is no fixed list of
		tags and what they mean and new ones can be made up at any time.  You
		do not know which tag is telling you the type of the feature and which
		tags are just incidental.  It is also possible that you need to look at
		more than one tag to get the map feature.  For example with towns you
		may want to look at the population tag to work out how it is to be
		represented in Garmin features.  We have to have a look up table that
		maps OSM tags to garmin types and subtypes.</li>
</ul>
</body>
